<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <link rel="icon" href="assets/imgs/favicon.ico" type="image/x-icon">
    <title>Quartz QR</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600&family=Roboto:wght@400;500&display=swap"
          rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <link rel="stylesheet" href="assets/app.css"/>
</head>
<!-- Chat Widget -->
<div id="chat-widget" style="position:fixed;bottom:20px;right:20px;z-index:1000;">
    <button id="chat-toggle"
            style="width:60px;height:60px;border-radius:50%;background:#0066cc;color:white;border:none;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,0.3);">
        ðŸ’¬ - C
    </button>
    <div id="chat-box"
         style="display:none;position:absolute;bottom:70px;right:0;width:350px;height:450px;background:white;border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,0.2);flex-direction:column;">
        <div style="padding:12px;background:#0066cc;color:white;border-radius:12px 12px 0 0;font-weight:bold;">
            Quartz QR Assistant
        </div>
        <div id="chat-messages" style="flex:1;overflow-y:auto;padding:12px;"></div>
        <div style="padding:12px;border-top:1px solid #eee;display:flex;gap:8px;">
            <input id="chat-input" type="text" placeholder="Ask your question..."
                   style="flex:1;padding:8px;border:1px solid #ddd;border-radius:6px;">
            <button id="chat-send"
                    style="padding:8px 16px;background:#0066cc;color:white;border:none;border-radius:6px;cursor:pointer;">
                Send
            </button>
        </div>
    </div>
</div>

<body>
<div id="site-header"></div>

<main style="max-width:1100px;margin:0 auto;padding:10px 16px 30px;">
    <section class="card" style="padding:22px;">
        <h1 class="ty-headline">Quartz Qr Scan</h1>
        <p class="ty-body-2" style="margin-top:6px;color:#55666A;">
            Secure One-Time Qr Codes With Points And Promotions.
        </p>
        <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:14px;">
            <a class="btn btn-primary ty-button" href="login.html" data-guest-only>Login</a>
            <a class="btn btn-outline ty-button" href="register.html" data-guest-only>Register</a>
        </div>
    </section>

    <section style="margin-top:18px;">
        <div style="display:flex;align-items:end;justify-content:space-between;gap:12px;flex-wrap:wrap;">
            <!--
            <h2 class="ty-headline">Promotions Catalog</h2>
            <p class="ty-caption" style="color:#7A8C92;">Visible For Everyone, Even When Not Signed In. <br>
                <strong>A SUPPRIMER UNE FOIS LE SITE TERMINE</strong> -->

            </p>
        </div>

        <div data-promotions-grid class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-3"></div>
    </section>
</main>


<div id="site-footer"></div>
<script src="assets/chat.js"></script>


<script src="assets/app-state.js"></script>
<script src="assets/supabase-client.js"></script>
<script src="assets/auth.js"></script>
<script src="assets/app-api.js"></script>
<script src="assets/include.js"></script>

<script>
    (async () => {
        // Promotions are public. For unlock display, use shop points if logged in.
        const promos = await listPublicPromotions();
        const shop = await getShopTotal(); // returns null if not signed in
        const shopPoints = shop?.shop_points ?? 0;
        renderPromotions("[data-promotions-grid]", promos, shopPoints);
    })();
</script>

</body>
</html>
